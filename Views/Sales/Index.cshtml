@{
    ViewData["Title"] = "Commandes du restaurant";
    Layout = "_Layout";
}

<div class="container">
    @{
        var restaurant = (BoutiqueElegance.Models.Restaurant?)ViewBag.Restaurant;
        var orders = (IList<BoutiqueElegance.Models.Order>)(ViewBag.Orders ?? new List<BoutiqueElegance.Models.Order>());
        var totalRevenue = (decimal)(ViewBag.TotalRestaurantRevenue ?? 0m);
    }

    <h2 class="page-title mb-4">
        <i class="bi bi-shop-window me-2"></i>Commandes de @restaurant?.Name
    </h2>

    @if (restaurant == null)
    {
        <div class="empty-state text-center py-5">
            <div class="empty-state-icon mb-3">
                <i class="bi bi-emoji-frown text-muted display-4"></i>
            </div>
            <h3>Aucun restaurant associé</h3>
            <p class="text-muted">Aucun restaurant n'est associé à votre compte vendeur.</p>
        </div>
    }
    else if (orders.Count == 0)
    {
        <div class="empty-state text-center py-5">
            <div class="empty-state-icon mb-3">
                <i class="bi bi-box-seam text-muted display-4"></i>
            </div>
            <h3>Aucune commande pour le moment</h3>
            <p class="text-muted">Vous n'avez pas encore reçu de commande pour ce restaurant.</p>
        </div>
    }
    else
    {
        <p class="mb-3">
            <i class="bi bi-graph-up-arrow me-1"></i>
            Montant total gagné :
            <strong>
                <i class="bi bi-currency-dollar me-1"></i>@totalRevenue.ToString("0.00")
            </strong>
        </p>

        <div class="orders-grid row g-3">
            @foreach (var order in orders)
            {
                <div class="order-card col-md-6 col-lg-4">
                    <div class="card h-100">
                        <!-- En-tête -->
                        <div class="order-header card-header">
                            <div class="order-info">
                                <h3 class="order-number h6 mb-1">
                                    <i class="bi bi-receipt me-1"></i>Commande #@order.Id
                                </h3>
                                <p class="order-date text-muted mb-0 small">
                                    <i class="bi bi-calendar-event me-1"></i>
                                    @order.CreatedAt.ToLocalTime().ToString("dd/MM/yyyy - HH:mm")
                                </p>
                                <p class="order-client text-muted mb-0 small">
                                    <i class="bi bi-person me-1"></i>
                                    @order.Client.FullName
                                </p>
                            </div>
                        </div>

                        <!-- Corps -->
                        <div class="order-body card-body d-flex justify-content-between align-items-center">
                            <div class="order-total">
                                <span class="total-label text-muted">Total:</span>
                                <span class="total-amount fw-semibold ms-1">
                                    <i class="bi bi-currency-dollar me-1"></i>
                                    @order.TotalAmount.ToString("0.00")
                                </span>
                            </div>
                        </div>

                        <!-- Footer -->
                        <div class="order-footer card-footer text-end">
                            <a asp-controller="Sales"
                               asp-action="Details"
                               asp-route-id="@order.Id"
                               class="btn btn-sm btn-outline-primary">
                                <i class="bi bi-eye me-1"></i>Voir les détails
                            </a>
                        </div>
                    </div>
                </div>
            }
        </div>
    }
</div>

